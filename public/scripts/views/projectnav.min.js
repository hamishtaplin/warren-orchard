(function(e){e.App=e.App||{},App.Views=App.Views||{},App.Views.JobNavView=Backbone.View.extend({tagName:"div",className:"project-view",initialize:function(e){_.bindAll(this,"load","onAjaxLoaded","show","onSliderLoaded","onSliderPrev","onSliderNext","onBtnClick"),this.projectIDs=e.projectIDs,this.render()},render:function(){var e=document.getElementById("header");this.projects=[];for(var t=0;t<this.projectIDs.length;t++){var i=this.projectIDs[t],n={id:i,el:document.createElement("div")};n.el.setAttribute("class","project-view-item"),n.el.setAttribute("id","project-"+i),this.projects[i]=n,this.el.appendChild(n.el)}this.nextBtn=this.makeBtn("next"),this.prevBtn=this.makeBtn("prev"),e.parentNode.insertBefore(this.el,e.nextSibling)},makeBtn:function(e){var t=document.createElement("div");return t.className="btn  btn-"+e,t.innerHTML=e,t.addEventListener("click",this.onBtnClick),this.el.appendChild(t),t},onBtnClick:function(e){e.target===this.nextBtn?this.currentJob.slider.next():e.target===this.prevBtn&&this.currentJob.slider.prev()},show:function(){this.el.classList.add("is-visible")},hide:function(){this.el.classList.remove("is-visible")},load:function(e){this.currentJob=this.projects[e],Backbone.ajax({url:"/project-ajax",data:{id:e},success:this.onAjaxLoaded})},onAjaxLoaded:function(e){this.currentJob.el.innerHTML=e,this.currentJob.imgLoader=new App.Views.ImageLoader({imgs:this.currentJob.el.querySelectorAll(".gallery-item"),useBg:!0}),this.initSlider()},initSlider:function(){this.currentJob.slider=new App.Views.Slider({animType:"fade",el:document.getElementById("gallery"),innerEl:document.getElementById("gallery-inner")}),this.currentJob.imgLoader.on("progress:complete",this.onSliderLoaded),this.currentJob.slider.on("slidechanged",this.onSlideChanged),this.currentJob.slider.on("navigate:next",this.onSliderNext),this.currentJob.slider.on("navigate:prev",this.onSliderPrev)},onSliderLoaded:function(){// if (!window.DEBUG) {
this.trigger("loaded")},onSliderPrev:function(){this.unloadCurrentJob("prev")},onSliderNext:function(){this.unloadCurrentJob("next")},unloadCurrentJob:function(e){var t=this.projectIDs.indexOf(this.currentJobID),i=0;i="next"===e?t+1:t-1,this.load(this.projectIDs[i])},onSlideChanged:function(e){console.log("changed: ",e)}})}).call(this,window,Zepto);