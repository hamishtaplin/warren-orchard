window.App=window.App||{},App.Views=App.Views||{},function(e){App.Views.AppView=Backbone.View.extend({el:"body",initialize:function(){_.bindAll(this,"onClick","infoRoute","projectRoute","homeRoute","onProjectLoaded"),App.eventDispatcher=_.clone(Backbone.Events),e.onload=_.bind(this.onWindowLoad,this),this.progressView=new App.Views.ProgressBar,this.thumbsView=new App.Views.Thumbnails,this.projectsNavView=new App.Views.ProjectNav,App.eventDispatcher.on("progress:change",this.progressView.update),App.eventDispatcher.on("progress:complete",this.progressView.complete),this.initRouter()},initRouter:function(){App.router=new App.Router,App.router.on("route:projects",this.homeRoute),App.router.on("route:info",this.infoRoute),App.router.on("route:project",this.projectRoute),Backbone.history.start({pushState:!0}),document.addEventListener("click",this.onClick,!1)},onClick:function(e){for(var t=e.target;t&&"A"!==t.tagName;)t=t.parentNode;return null===t||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey?void 0:(e.preventDefault(),href=t.getAttribute("href"),url=href.replace(/^\//,"").replace("#!/",""),App.router.navigate(url,{trigger:!0}),!1)},homeRoute:function(){App.router.navigate("home",{trigger:!0})},projectRoute:function(e,t){this.projectsNavView.on("loaded",this.onProjectLoaded),this.projectsNavView.navigateTo(e,t)},infoRoute:function(){},onProjectLoaded:function(){this.projectsNavView.off("loaded"),this.projectsNavView.show(),this.thumbsView.hide()},homeRoute:function(){_.delay(this.thumbsView.show,500),this.projectsNavView.hide()},onWindowLoad:function(){this.el.className+="loaded"}});new App.Views.AppView}.call(this,window,Zepto);