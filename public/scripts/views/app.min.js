window.App=window.App||{},App.Views=App.Views||{},function(e){App.Views.AppView=Backbone.View.extend({el:"body",initialize:function(){var t=[];_.bindAll(this,"projectRoute","homeRoute","rootRoute","onProjectLoaded"),App.eventDispatcher=_.clone(Backbone.Events),e.onload=_.bind(this.onWindowLoad,this),this.progress=new App.Views.ProgressBar,this.thumbsView=new App.Views.Thumbnails;for(var o=0;o<this.thumbsView.thumbs.length;o++)t.push(this.thumbsView.thumbs[o].getAttribute("data-project-id"));this.projectsNavView=new App.Views.ProjectNavView({projectIDs:t}),App.eventDispatcher.on("progress:change",this.progress.update),App.eventDispatcher.on("progress:complete",this.progress.complete),this.initRouter()},initRouter:function(){var e=new App.Router;this.router=e,this.router.on("route:root",this.rootRoute),this.router.on("route:home",this.homeRoute),this.router.on("route:project",this.projectRoute),this.projectsNavView.on("route:project",function(t,o){console.log("route:project",t,o),e.navigate("#projects/"+t+"/"+o,{trigger:!0})}),Backbone.history.start({pushState:!1})},rootRoute:function(){this.router.navigate("#home",{trigger:!0})},projectRoute:function(e,t){var o=this.projectsNavView.currentProject;"undefined"!=typeof o&&o.id===e?this.projectsNavView.currentProject.slider.navigateTo(t):(this.projectsNavView.on("loaded",this.onProjectLoaded),this.projectsNavView.loadProject(e,t))},onProjectLoaded:function(){this.projectsNavView.off("loaded"),this.projectsNavView.show(),this.thumbsView.hide()},homeRoute:function(){_.delay(this.thumbsView.show,500),this.projectsNavView.hide()},onWindowLoad:function(){this.el.className+="loaded"}});new App.Views.AppView}.call(this,window,Zepto);